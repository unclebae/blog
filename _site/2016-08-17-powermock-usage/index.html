<!DOCTYPE html>
<html lang="en">
  <!-- Beautiful Jekyll | MIT license | Copyright Dean Attali 2016 -->
  <head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">

  <title>Powermock MockitoUsage</title>

  <meta name="author" content="Bae Ki Do" />
  
  

  <link rel="alternate" type="application/rss+xml" title="UncleBae Story - I will do everything I believe or I think." href="/feed.xml" />

  
    
      <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css" />
    
      
  
  
    
      <link rel="stylesheet" href="/css/bootstrap.min.css" />
    
      <link rel="stylesheet" href="/css/main.css" />
    
    
  
  
    
      <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic" />
    
      <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800" />
    
  

    
  
  

  

  <!-- Facebook OpenGraph tags -->
  <meta property="og:title" content="Powermock MockitoUsage" />
  <meta property="og:type" content="website" />
  
  <meta property="og:url" content="http://unclebae.github.io/2016-08-17-powermock-usage//" />
  
  
  <meta property="og:image" content="http://unclebae.github.io/img/avatar-icon.png" />
  
  
  <!-- Twitter summary cards -->
  <meta name="twitter:card" content="summary" />
  <meta name="twitter:site" content="@baekido" />
  <meta name="twitter:creator" content="@baekido" />
  <meta name="twitter:title" content="Powermock MockitoUsage" />
  <meta name="twitter:description" content="from : https://github.com/jayway/powermock/wiki/MockitoUsage powermock과 mockito를 연동하여 사용하기. 소개 기본적으로 PowerMock은 “PowerMockito” 라고 불리는 클래스를 제공하며 이는 mock/object/class를 생성하는 작업과 초기화, 검증, 기대에 대한 작업을 수행할 수 있으며 이는 그대로 Mockito를 이용하여 이러한 작업을 할 수 있다. 모든 사용에는 @RunWith(PowerMockRunner.class)와 @PrepareForTest 어노테이션을 클래스 레벨에서 필요로 한다. 지원버젼 Mockito PowerMock 2.0.0-beta -..." />
  
  <meta name="twitter:image" content="http://unclebae.github.io/img/avatar-icon.png" />
  
  
</head>


  <body>
  
    <nav class="navbar navbar-default navbar-fixed-top navbar-custom">
  <div class="container-fluid">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#main-navbar">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="http://unclebae.github.io">UncleBae Story</a>
    </div>

    <div class="collapse navbar-collapse" id="main-navbar">
      <ul class="nav navbar-nav navbar-right">
      
        
          <li>
            
            





<a href="/about">About Me</a>

          </li>
        
        
        
          <li>
            
            





<a href="https://github.com/unclebae">GitHub</a>

          </li>
        
        
        
          <li class="navlinks-container">
            <a class="navlinks-parent" href="javascript:void(0)">Resources</a>
            <div class="navlinks-children">
              
                
                  
            





<a href="http://deanattali.com/beautiful-jekyll/">Beautiful Jekyll</a>

                
              
                
                  
            





<a href="http://www.markdowntutorial.com/">Learn markdown</a>

                
              
                
                  
            





<a href="https://pages.github.com/">GitHub Pages</a>

                
              
            </div>
          </li>
        
        
        
          <li>
            
            





<a href="http://uncle-bae.blogspot.kr/">BLOG</a>

          </li>
        
        
      </ul>
    </div>

	
	<div class="avatar-container">
	  <div class="avatar-img-border">
	    <a href="http://unclebae.github.io ">
	      <img class="avatar-img" src="/img/avatar-icon.png" />
		</a>
	  </div>
	</div>
	

  </div>
</nav>


    <!-- TODO this file has become a mess, refactor it -->





<header class="header-section ">

<div class="intro-header no-img">
  <div class="container">
    <div class="row">
      <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
        <div class="post-heading">
          <h1>Powermock MockitoUsage</h1>
		  
		  
		  
		  <span class="post-meta">Posted on August 17, 2016</span>
		  
        </div>
      </div>
    </div>
  </div>
</div>
</header>




<div class="container">
  <div class="row">
    <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
      <article role="main" class="blog-post">
	      <p>from : <a href="https://github.com/jayway/powermock/wiki/MockitoUsage">https://github.com/jayway/powermock/wiki/MockitoUsage</a></p>

<h1 id="powermock-mockito--">powermock과 mockito를 연동하여 사용하기.</h1>

<h2 id="section">소개</h2>

<p>기본적으로 PowerMock은 “PowerMockito” 라고 불리는 클래스를 제공하며 이는 mock/object/class를 생성하는 작업과 초기화, 검증, 기대에 대한 작업을 수행할 수 있으며 이는 그대로 Mockito를 이용하여 이러한 작업을 할 수 있다.</p>

<p>모든 사용에는 <code class="highlighter-rouge">@RunWith(PowerMockRunner.class)</code>와 <code class="highlighter-rouge">@PrepareForTest</code> 어노테이션을 클래스 레벨에서 필요로 한다.</p>

<h2 id="section-1">지원버젼</h2>

<table>
  <tbody>
    <tr>
      <td>Mockito</td>
      <td>PowerMock</td>
    </tr>
    <tr>
      <td>2.0.0-beta - 2.0.42-beta</td>
      <td>1.6.5+</td>
    </tr>
    <tr>
      <td>1.10.8 - 1.10.x</td>
      <td>1.6.2+</td>
    </tr>
    <tr>
      <td>1.9.5-rc1 - 1.9.5</td>
      <td>1.5.0 - 1.5.6</td>
    </tr>
    <tr>
      <td>1.9.0-rc1 &amp; 1.9.0</td>
      <td>1.4.10 - 1.4.12</td>
    </tr>
    <tr>
      <td>1.8.5</td>
      <td>1.3.9 - 1.4.9</td>
    </tr>
    <tr>
      <td>1.8.4</td>
      <td>1.3.7 &amp; 1.3.8</td>
    </tr>
    <tr>
      <td>1.8.3</td>
      <td>1.3.6</td>
    </tr>
    <tr>
      <td>1.8.1 &amp; 1.8.2</td>
      <td>1.3.5</td>
    </tr>
    <tr>
      <td>1.8</td>
      <td>1.3</td>
    </tr>
    <tr>
      <td>1.7</td>
      <td>1.2.5</td>
    </tr>
  </tbody>
</table>

<hr />

<h2 id="section-2">사용법</h2>

<p>아래 예제에서는 static import를 이용하지 않는다. 여기서는 Mockito, PowerMockito를 그대로 이용하여 이해를 쉽게 할 것이다. 실제 사용할때에는 static import 메소드를 사용할 것을 권장한다. 이는 읽기를 향상 시킬 것이다.</p>

<hr />

<h3 id="mocking-static-method-">Mocking Static Method 이용하기.</h3>

<p>Step 1. 
@PrepareForTest를 클래스 레벨에 걸어준다.</p>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="nd">@PrepareForTest</span><span class="o">(</span><span class="n">Static</span><span class="o">.</span><span class="na">class</span><span class="o">)</span> <span class="c1">// Static.class 는 정적 메소드를 포함하는 클래스이다.</span></code></pre></figure>

<p>Step 2.
PowerMockito.mockStatic() 을 호출한다. 이는 PowerMockito.spy(class)를 이용하도록 정적 메소드를 사용 등록한다.</p>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="n">PowerMockito</span><span class="o">.</span><span class="na">mockStatic</span><span class="o">(</span><span class="n">Static</span><span class="o">.</span><span class="na">class</span><span class="o">);</span></code></pre></figure>

<p>Step 3. 
Mockito.when() 을 이용하여 필요한 기대값을 지정한다.</p>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="n">Mockito</span><span class="o">.</span><span class="na">when</span><span class="o">(</span><span class="n">Static</span><span class="o">.</span><span class="na">firstStaticMethod</span><span class="o">(</span><span class="n">param</span><span class="o">)).</span><span class="na">thenReturn</span><span class="o">(</span><span class="n">value</span><span class="o">);</span></code></pre></figure>

<hr />

<h4 id="behavior-">behavior 검증방법</h4>

<p>static method의 검증은 다음 2가지 스텝으로 가능하다.</p>

<ol>
  <li>우선 PowerMockito.verifyStatic()을 호출하고, 행위를 검증한다. 그리고</li>
  <li>static method를 호출하여 검증한다.</li>
</ol>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="n">PowerMockito</span><span class="o">.</span><span class="na">verifyStatic</span><span class="o">();</span> <span class="c1">// 1</span>
<span class="n">Static</span><span class="o">.</span><span class="na">firstStaticMethod</span><span class="o">(</span><span class="n">param</span><span class="o">);</span> <span class="c1">// 2</span></code></pre></figure>

<ul>
  <li>중요 : verifyStatic()을 각 검증메소드 마다 호출해야한다.</li>
</ul>

<hr />

<h4 id="section-3">아규먼트 매처를 어떻게 사용하는가?</h4>

<p>모키토 매처는 아마도 PowerMock 목에 적용될 것이다. 예를 들어 커스텀 아규먼트 매처를 각 목된 정적 메소드에 적용할 수 있다.</p>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="n">PowerMockito</span><span class="o">.</span><span class="na">verifyStatic</span><span class="o">();</span>
<span class="n">Static</span><span class="o">.</span><span class="na">thirdStaticMethod</span><span class="o">(</span><span class="n">Mockito</span><span class="o">.</span><span class="na">anyInt</span><span class="o">());</span></code></pre></figure>

<hr />

<h4 id="section-4">어떻게 정확하게 호출 카운트를 셀 수 있을까?</h4>

<p>Mockito.VerificationMode를 이용할 수 있다. (예) Mockito.times(x) 이며 이는 PowerMockito.verifyStatic(Mockito.times(2))이용하게 된다.</p>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="n">PowerMockito</span><span class="o">.</span><span class="na">verifyStatic</span><span class="o">(</span><span class="n">Mockito</span><span class="o">.</span><span class="na">times</span><span class="o">(</span><span class="mi">1</span><span class="o">));</span></code></pre></figure>

<hr />

<h4 id="void-static--exception-----">어떻게 void static 메소드의 exception을 던지는 것을 스텁할 수 있는가?</h4>

<p>만약 private 아니라면</p>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="n">PowerMockito</span><span class="o">.</span><span class="na">doThrow</span><span class="o">(</span><span class="k">new</span> <span class="n">ArrayStoreException</span><span class="o">(</span><span class="s">"Mock error"</span><span class="o">)).</span><span class="na">when</span><span class="o">(</span><span class="n">StaticService</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
<span class="n">StaticService</span><span class="o">.</span><span class="na">executeMethod</span><span class="o">();</span></code></pre></figure>

<p>동일하게 final classes/methods에도 적용할 수 있다.</p>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="n">PowerMockito</span><span class="o">.</span><span class="na">doThrow</span><span class="o">(</span><span class="k">new</span> <span class="n">ArrayStoreException</span><span class="o">(</span><span class="s">"Mock error"</span><span class="o">)).</span><span class="na">when</span><span class="o">(</span><span class="n">myFinalMock</span><span class="o">).</span><span class="na">myFinalMethod</span><span class="o">();</span></code></pre></figure>

<p>private 메소드에는 PowerMockito.when 을 이용한다.</p>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="n">when</span><span class="o">(</span><span class="n">tested</span><span class="o">,</span> <span class="s">"methodToExpect"</span><span class="o">,</span> <span class="n">argument</span><span class="o">).</span><span class="na">thenReturn</span><span class="o">(</span><span class="n">myReturnValue</span><span class="o">);</span></code></pre></figure>

<hr />

<h4 id="section-5">전체 예제</h4>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="nd">@RunWith</span><span class="o">(</span><span class="n">PowerMockRunner</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
<span class="nd">@PrepareForTest</span><span class="o">(</span><span class="n">Static</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">YourTestCase</span> <span class="o">{</span>
    <span class="nd">@Test</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">testMethodThatCallsStaticMethod</span><span class="o">()</span> <span class="o">{</span>
        <span class="c1">// mock all the static methods in a class called "Static"</span>
        <span class="n">PowerMockito</span><span class="o">.</span><span class="na">mockStatic</span><span class="o">(</span><span class="n">Static</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
        <span class="c1">// use Mockito to set up your expectation</span>
        <span class="n">Mockito</span><span class="o">.</span><span class="na">when</span><span class="o">(</span><span class="n">Static</span><span class="o">.</span><span class="na">firstStaticMethod</span><span class="o">(</span><span class="n">param</span><span class="o">)).</span><span class="na">thenReturn</span><span class="o">(</span><span class="n">value</span><span class="o">);</span>
        <span class="n">Mockito</span><span class="o">.</span><span class="na">when</span><span class="o">(</span><span class="n">Static</span><span class="o">.</span><span class="na">secondStaticMethod</span><span class="o">()).</span><span class="na">thenReturn</span><span class="o">(</span><span class="mi">123</span><span class="o">);</span>

        <span class="c1">// execute your test</span>
        <span class="n">classCallStaticMethodObj</span><span class="o">.</span><span class="na">execute</span><span class="o">();</span>

        <span class="c1">// Different from Mockito, always use PowerMockito.verifyStatic() first</span>
        <span class="c1">// to start verifying behavior</span>
        <span class="n">PowerMockito</span><span class="o">.</span><span class="na">verifyStatic</span><span class="o">(</span><span class="n">Mockito</span><span class="o">.</span><span class="na">times</span><span class="o">(</span><span class="mi">2</span><span class="o">));</span>
        <span class="c1">// IMPORTANT:  Call the static method you want to verify</span>
        <span class="n">Static</span><span class="o">.</span><span class="na">firstStaticMethod</span><span class="o">(</span><span class="n">param</span><span class="o">);</span>


        <span class="c1">// IMPORTANT: You need to call verifyStatic() per method verification, </span>
        <span class="c1">// so call verifyStatic() again</span>
        <span class="n">PowerMockito</span><span class="o">.</span><span class="na">verifyStatic</span><span class="o">();</span> <span class="c1">// default times is once</span>
        <span class="c1">// Again call the static method which is being verified </span>
        <span class="n">Static</span><span class="o">.</span><span class="na">secondStaticMethod</span><span class="o">();</span>

        <span class="c1">// Again, remember to call verifyStatic()</span>
        <span class="n">PowerMockito</span><span class="o">.</span><span class="na">verifyStatic</span><span class="o">(</span><span class="n">Mockito</span><span class="o">.</span><span class="na">never</span><span class="o">());</span>
        <span class="c1">// And again call the static method. </span>
        <span class="n">Static</span><span class="o">.</span><span class="na">thirdStaticMethod</span><span class="o">();</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre></figure>

<hr />

<h3 id="section-6">부분 모킹</h3>

<p>PowerMockito.spy를 이용하여 부분 모킹을 이용할 수 있다. 주의할 것은 (다음은 Mockito 문서에서 획득한 것으로 PowerMockito에 잘 적용된다.)</p>

<p>가끔 spy들을 스터빙 하기위해 when(…)을 직접 이용하지 않아도 된다.</p>

<p>예제)</p>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="n">List</span> <span class="n">list</span> <span class="o">=</span> <span class="k">new</span> <span class="n">LinkedList</span><span class="o">();</span>
<span class="n">List</span> <span class="n">spy</span> <span class="o">=</span> <span class="n">spy</span><span class="o">(</span><span class="n">list</span><span class="o">);</span>
<span class="c1">//Impossible: real method is called so spy.get(0) throws IndexOutOfBoundsException (the list is yet empty)</span>
<span class="n">when</span><span class="o">(</span><span class="n">spy</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="mi">0</span><span class="o">)).</span><span class="na">thenReturn</span><span class="o">(</span><span class="s">"foo"</span><span class="o">);</span>

<span class="c1">//You have to use doReturn() for stubbing</span>
<span class="n">doReturn</span><span class="o">(</span><span class="s">"foo"</span><span class="o">).</span><span class="na">when</span><span class="o">(</span><span class="n">spy</span><span class="o">).</span><span class="na">get</span><span class="o">(</span><span class="mi">0</span><span class="o">);</span></code></pre></figure>

<hr />

<h4 id="behavior--1">behavior 검증방법</h4>

<p>Mockito.verify()를 이용하여 검증이 가능하다.</p>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="n">Mockito</span><span class="o">.</span><span class="na">verify</span><span class="o">(</span><span class="n">mockObj</span><span class="o">,</span> <span class="n">times</span><span class="o">(</span><span class="mi">2</span><span class="o">)).</span><span class="na">methodToMock</span><span class="o">();</span></code></pre></figure>

<hr />

<h4 id="private-behavior-">private behavior 검증하기.</h4>

<p>PowerMockito.verifyPrivate()를 이용한다.</p>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="n">verifyPrivate</span><span class="o">(</span><span class="n">tested</span><span class="o">).</span><span class="na">invoke</span><span class="o">(</span><span class="s">"privateMethodName"</span><span class="o">,</span> <span class="n">argument1</span><span class="o">);</span></code></pre></figure>

<p>이것은 또한 private static methods로 동작한다.</p>

<hr />

<h4 id="section-7">새로운 객체의 생성자를 어떻게 목을 하는가?</h4>

<p>PowerMockito.whenNew를 이용한다.</p>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="n">whenNew</span><span class="o">(</span><span class="n">MyClass</span><span class="o">.</span><span class="na">class</span><span class="o">).</span><span class="na">withNoArguments</span><span class="o">().</span><span class="na">thenThrow</span><span class="o">(</span><span class="k">new</span> <span class="n">IOException</span><span class="o">(</span><span class="s">"error message"</span><span class="o">));</span></code></pre></figure>

<p>테스트를 위해서 MyClass의 인스턴스를 생성을 위해서 준비해야한다. 만약 클래스를 new MyClass()가 X에 호출되면 당신은 @PrepareForTest(X.class)를 수행해야한다. 이는 whenNew를 위한 작업이다.</p>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="nd">@RunWith</span><span class="o">(</span><span class="n">PowerMockRunner</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
<span class="nd">@PrepareForTest</span><span class="o">(</span><span class="n">X</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">XTest</span> <span class="o">{</span>
        <span class="nd">@Test</span>
        <span class="kd">public</span> <span class="kt">void</span> <span class="nf">test</span><span class="o">()</span> <span class="o">{</span>
                <span class="n">whenNew</span><span class="o">(</span><span class="n">MyClass</span><span class="o">.</span><span class="na">class</span><span class="o">).</span><span class="na">withNoArguments</span><span class="o">().</span><span class="na">thenThrow</span><span class="o">(</span><span class="k">new</span> <span class="n">IOException</span><span class="o">(</span><span class="s">"error message"</span><span class="o">));</span>

                <span class="n">X</span> <span class="n">x</span> <span class="o">=</span> <span class="k">new</span> <span class="n">X</span><span class="o">();</span>
                <span class="n">x</span><span class="o">.</span><span class="na">y</span><span class="o">();</span> <span class="c1">// y is the method doing "new MyClass()"</span>

                <span class="o">..</span>
        <span class="o">}</span>
<span class="o">}</span></code></pre></figure>

<hr />

<h4 id="section-8">객체 생성의 검증방법</h4>

<p>PowerMockito.verifyNew를 이용한다.</p>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="n">verifyNew</span><span class="o">(</span><span class="n">MyClass</span><span class="o">.</span><span class="na">class</span><span class="o">).</span><span class="na">withNoArguments</span><span class="o">();</span></code></pre></figure>

<hr />

<h4 id="section-9">아규먼트 매처 이용방법</h4>

<p>Mockito 매처를 PowerMock에 그대로 이용할 수 있다.</p>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="n">Mockito</span><span class="o">.</span><span class="na">verify</span><span class="o">(</span><span class="n">mockObj</span><span class="o">).</span><span class="na">methodToMock</span><span class="o">(</span><span class="n">Mockito</span><span class="o">.</span><span class="na">anyInt</span><span class="o">());</span>  </code></pre></figure>

<hr />

<h4 id="spying-">spying예제 전체보기.</h4>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="nd">@RunWith</span><span class="o">(</span><span class="n">PowerMockRunner</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
<span class="c1">// We prepare PartialMockClass for test because it's final or we need to mock private or static methods</span>
<span class="nd">@PrepareForTest</span><span class="o">(</span><span class="n">PartialMockClass</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">YourTestCase</span> <span class="o">{</span>
    <span class="nd">@Test</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">spyingWithPowerMock</span><span class="o">()</span> <span class="o">{</span>        
        <span class="n">PartialMockClass</span> <span class="n">classUnderTest</span> <span class="o">=</span> <span class="n">PowerMockito</span><span class="o">.</span><span class="na">spy</span><span class="o">(</span><span class="k">new</span> <span class="n">PartialMockClass</span><span class="o">());</span>

        <span class="c1">// use Mockito to set up your expectation</span>
        <span class="n">Mockito</span><span class="o">.</span><span class="na">when</span><span class="o">(</span><span class="n">classUnderTest</span><span class="o">.</span><span class="na">methodToMock</span><span class="o">()).</span><span class="na">thenReturn</span><span class="o">(</span><span class="n">value</span><span class="o">);</span>

        <span class="c1">// execute your test</span>
        <span class="n">classUnderTest</span><span class="o">.</span><span class="na">execute</span><span class="o">();</span>

        <span class="c1">// Use Mockito.verify() to verify result</span>
        <span class="n">Mockito</span><span class="o">.</span><span class="na">verify</span><span class="o">(</span><span class="n">mockObj</span><span class="o">,</span> <span class="n">times</span><span class="o">(</span><span class="mi">2</span><span class="o">)).</span><span class="na">methodToMock</span><span class="o">();</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre></figure>

<hr />

<h4 id="private---">private메소드의 부분 모킹 예제</h4>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="nd">@RunWith</span><span class="o">(</span><span class="n">PowerMockRunner</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
<span class="c1">// We prepare PartialMockClass for test because it's final or we need to mock private or static methods</span>
<span class="nd">@PrepareForTest</span><span class="o">(</span><span class="n">PartialMockClass</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">YourTestCase</span> <span class="o">{</span>
    <span class="nd">@Test</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">privatePartialMockingWithPowerMock</span><span class="o">()</span> <span class="o">{</span>        
        <span class="n">PartialMockClass</span> <span class="n">classUnderTest</span> <span class="o">=</span> <span class="n">PowerMockito</span><span class="o">.</span><span class="na">spy</span><span class="o">(</span><span class="k">new</span> <span class="n">PartialMockClass</span><span class="o">());</span>

        <span class="c1">// use PowerMockito to set up your expectation</span>
        <span class="n">PowerMockito</span><span class="o">.</span><span class="na">doReturn</span><span class="o">(</span><span class="n">value</span><span class="o">).</span><span class="na">when</span><span class="o">(</span><span class="n">classUnderTest</span><span class="o">,</span> <span class="s">"methodToMock"</span><span class="o">,</span> <span class="s">"parameter1"</span><span class="o">);</span>

        <span class="c1">// execute your test</span>
        <span class="n">classUnderTest</span><span class="o">.</span><span class="na">execute</span><span class="o">();</span>

        <span class="c1">// Use PowerMockito.verify() to verify result</span>
        <span class="n">PowerMockito</span><span class="o">.</span><span class="na">verifyPrivate</span><span class="o">(</span><span class="n">classUnderTest</span><span class="o">,</span> <span class="n">times</span><span class="o">(</span><span class="mi">2</span><span class="o">)).</span><span class="na">invoke</span><span class="o">(</span><span class="s">"methodToMock"</span><span class="o">,</span> <span class="s">"parameter1"</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>  </code></pre></figure>

<div id="disqus_thread"></div>
<script>
   /**
     *  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
     *  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables
     */
    /*
    var disqus_config = function () {
        this.page.url = PAGE_URL;  // Replace PAGE_URL with your page's canonical URL variable
        this.page.identifier = PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
    };
    */
    (function() {  // DON'T EDIT BELOW THIS LINE
        var d = document;
        s = d.createElement('script'); 
        s.src = '//https-unclebae-github-io.disqus.com/embed.js';
        
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>

<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>


	    </article>
	  	  
      <ul class="pager blog-pager">
        
        <li class="previous">
          <a href="/2016-08-11-tomcat-jdbc-connection-pool/" data-toggle="tooltip" data-placement="top" title="Tomcat JDBC Connection Pool 소개">&larr; Previous Post</a>
        </li>
        
        
        <li class="next">
          <a href="/2016-08-17-powermock/" data-toggle="tooltip" data-placement="top" title="Using powermock with junit 4.12">Next Post &rarr;</a>
        </li>
        
      </ul>
      
	    
        <div class="disqus-comments">
	        

        </div>
	    
    </div>
  </div>
</div>


    <footer>
  <div class="container beautiful-jekyll-footer">
    <div class="row">
      <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
        <ul class="list-inline text-center footer-links">
          
          <li>
            <a href="https://www.facebook.com/baekido" title="Facebook">
              <span class="fa-stack fa-lg">
                <i class="fa fa-circle fa-stack-2x"></i>
                <i class="fa fa-facebook fa-stack-1x fa-inverse"></i>
              </span>
            </a>
          </li>
          
          
          <li>
            <a href="https://github.com/unclebae" title="GitHub">
              <span class="fa-stack fa-lg">
                <i class="fa fa-circle fa-stack-2x"></i>
                <i class="fa fa-github fa-stack-1x fa-inverse"></i>
              </span>
            </a>
          </li>
          
		  
          <li>
            <a href="mailto:baekido@gmail.com" title="Email me">
              <span class="fa-stack fa-lg">
                <i class="fa fa-circle fa-stack-2x"></i>
                <i class="fa fa-envelope fa-stack-1x fa-inverse"></i>
              </span>
            </a>
          </li>
          
		  
		  
		  		  
        </ul>
        <p class="copyright text-muted">
		  Bae Ki Do
		  &nbsp;&bull;&nbsp;
		  2016
		  
		  
		  &nbsp;&bull;&nbsp;
		  <a href="http://unclebae.github.io">unclebae.github.io</a>
		  
	    </p>
	        <!-- Please don't remove this, keep my open source work credited :) -->
		<p class="theme-by text-muted">
		  Theme by
		  <a href="http://deanattali.com/beautiful-jekyll/">beautiful-jekyll</a>
		</p>
      </div>
    </div>
  </div>
</footer>

  
    






  
    <!-- doing something a bit funky here because I want to be careful not to include JQuery twice! -->
    
      <script>
      	if (typeof jQuery == 'undefined') {
      	  document.write('<script src="/js/jquery-1.11.2.min.js"></scr' + 'ipt>');
      	}
      </script>
    
  
    <!-- doing something a bit funky here because I want to be careful not to include JQuery twice! -->
    
	<script src="/js/bootstrap.min.js"></script>
    
  
    <!-- doing something a bit funky here because I want to be careful not to include JQuery twice! -->
    
	<script src="/js/main.js"></script>
    
  




  
  </body>
</html>
